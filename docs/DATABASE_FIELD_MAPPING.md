# WCS Basketball - Database Field Mapping

## Overview

This document maps each form field in the WCS Basketball club management system to its corresponding database table and column in Supabase.

---

## üèÄ **COACHES MANAGEMENT**

### **Table: `coaches`**

| Form Field    | Database Column | Data Type | Required | Notes                       |
| ------------- | --------------- | --------- | -------- | --------------------------- |
| First Name    | `first_name`    | `text`    | ‚úÖ Yes   |                             |
| Last Name     | `last_name`     | `text`    | ‚úÖ Yes   |                             |
| Email         | `email`         | `text`    | ‚úÖ Yes   | Unique identifier           |
| Bio           | `bio`           | `text`    | ‚ùå No    | Optional description        |
| Quote         | `quote`         | `text`    | ‚ùå No    | Optional motivational quote |
| Image         | `image_url`     | `text`    | ‚ùå No    | URL to uploaded image       |
| Active Status | `is_active`     | `boolean` | ‚úÖ Yes   | Default: `true`             |

### **Related Tables**

- **`users`**: Contains authentication data linked by `email`
- **`auth.users`**: Supabase Auth table for login credentials

---

## üèÜ **TEAMS MANAGEMENT**

### **Table: `teams`**

| Form Field    | Database Column | Data Type | Required | Notes                                |
| ------------- | --------------- | --------- | -------- | ------------------------------------ |
| Team Name     | `name`          | `text`    | ‚úÖ Yes   |                                      |
| Age Group     | `age_group`     | `text`    | ‚úÖ Yes   | Options: U8, U10, U12, U14, U16, U18 |
| Description   | `description`   | `text`    | ‚ùå No    | Optional team description            |
| Logo          | `logo_url`      | `text`    | ‚ùå No    | URL to uploaded logo                 |
| Team Image    | `team_image`    | `text`    | ‚ùå No    | URL to uploaded team photo           |
| Active Status | `is_active`     | `boolean` | ‚úÖ Yes   | Default: `true`                      |

### **Storage Locations**

- **Logos**: `https://htgkddahhgugesktujds.supabase.co/storage/v1/object/public/images/logos/`
- **Team Images**: `https://htgkddahhgugesktujds.supabase.co/storage/v1/object/public/images/teams/`

---

## üë• **PLAYERS MANAGEMENT**

### **Table: `players`**

| Form Field      | Database Column | Data Type | Required | Notes                         |
| --------------- | --------------- | --------- | -------- | ----------------------------- |
| First Name      | `first_name`    | `text`    | ‚úÖ Yes   |                               |
| Last Name       | `last_name`     | `text`    | ‚úÖ Yes   |                               |
| Date of Birth   | `date_of_birth` | `date`    | ‚úÖ Yes   | Used for age calculation      |
| Age             | `age`           | `integer` | ‚úÖ Yes   | Calculated from date_of_birth |
| Gender          | `gender`        | `text`    | ‚úÖ Yes   | Options: Male, Female, Other  |
| Team Assignment | `team_id`       | `uuid`    | ‚ùå No    | Foreign key to teams table    |
| Active Status   | `is_active`     | `boolean` | ‚úÖ Yes   | Default: `true`               |

### **Related Tables**

- **`teams`**: Linked via `team_id` foreign key
- **Age Validation**: Uses `date_of_birth` to calculate age and validate team compatibility
- **Gender Validation**: Ensures gender compatibility with team type

---

## üìÖ **SCHEDULE MANAGEMENT**

### **Table: `schedules`**

| Form Field  | Database Column | Data Type     | Required | Notes                                  |
| ----------- | --------------- | ------------- | -------- | -------------------------------------- |
| Event Type  | `event_type`    | `text`        | ‚úÖ Yes   | Options: Game, Practice, Update, Drill |
| Title       | `title`         | `text`        | ‚ùå No    | Event title/name                       |
| Date & Time | `date_time`     | `timestamptz` | ‚úÖ Yes   | Event date and time                    |
| Opponent    | `opponent`      | `text`        | ‚ùå No    | For games only                         |
| Location    | `location`      | `text`        | ‚ùå No    | Event location                         |
| Comments    | `comments`      | `text`        | ‚ùå No    | Additional notes                       |
| Duration    | `duration`      | `text`        | ‚ùå No    | For practices only                     |
| Team        | `team_id`       | `uuid`        | ‚úÖ Yes   | Foreign key to teams table             |
| Created By  | `created_by`    | `uuid`        | ‚úÖ Yes   | Foreign key to users table             |

### **Event Type Specific Fields**

- **Games**: `opponent`, `location`, `comments`
- **Practices**: `title`, `duration`, `location`, `comments`
- **Updates**: `title`, `content` (stored in `comments`)
- **Drills**: `title`, `skills`, `equipment`, `time`, `instructions`, `additional_info`, `benefits`

---

## üì¢ **TEAM UPDATES**

### **Table: `team_updates`**

| Form Field   | Database Column | Data Type     | Required | Notes                      |
| ------------ | --------------- | ------------- | -------- | -------------------------- |
| Title        | `title`         | `text`        | ‚úÖ Yes   | Update title               |
| Content      | `content`       | `text`        | ‚úÖ Yes   | Update content             |
| Team         | `team_id`       | `uuid`        | ‚úÖ Yes   | Foreign key to teams table |
| Coach        | `coach_id`      | `uuid`        | ‚úÖ Yes   | Foreign key to users table |
| Created Date | `created_at`    | `timestamptz` | ‚úÖ Yes   | Auto-generated             |
| Deleted Date | `deleted_at`    | `timestamptz` | ‚ùå No    | Soft delete timestamp      |

---

## üí¨ **COACH MESSAGES**

### **Table: `coach_messages`**

| Form Field      | Database Column | Data Type     | Required | Notes                      |
| --------------- | --------------- | ------------- | -------- | -------------------------- |
| Message Content | `content`       | `text`        | ‚úÖ Yes   | Message text               |
| Author          | `author_id`     | `uuid`        | ‚úÖ Yes   | Foreign key to users table |
| Created Date    | `created_at`    | `timestamptz` | ‚úÖ Yes   | Auto-generated             |
| Updated Date    | `updated_at`    | `timestamptz` | ‚ùå No    | Last modification time     |
| Deleted Date    | `deleted_at`    | `timestamptz` | ‚ùå No    | Soft delete timestamp      |

---

## üèÉ **PRACTICE DRILLS**

### **Table: `practice_drills`**

| Form Field      | Database Column   | Data Type | Required | Notes                      |
| --------------- | ----------------- | --------- | -------- | -------------------------- |
| Title           | `title`           | `text`    | ‚úÖ Yes   | Drill name                 |
| Skills          | `skills`          | `text`    | ‚ùå No    | Skills developed           |
| Equipment       | `equipment`       | `text`    | ‚ùå No    | Required equipment         |
| Time            | `time`            | `text`    | ‚ùå No    | Duration                   |
| Instructions    | `instructions`    | `text`    | ‚ùå No    | Step-by-step instructions  |
| Additional Info | `additional_info` | `text`    | ‚ùå No    | Extra notes                |
| Benefits        | `benefits`        | `text`    | ‚ùå No    | Drill benefits             |
| Team            | `team_id`         | `uuid`    | ‚úÖ Yes   | Foreign key to teams table |
| Created By      | `created_by`      | `uuid`    | ‚úÖ Yes   | Foreign key to users table |

---

## üîê **AUTHENTICATION & USERS**

### **Table: `users`**

| Form Field     | Database Column  | Data Type     | Required | Notes                 |
| -------------- | ---------------- | ------------- | -------- | --------------------- |
| Email          | `email`          | `text`        | ‚úÖ Yes   | Unique identifier     |
| Role           | `role`           | `text`        | ‚úÖ Yes   | Options: admin, coach |
| Password Reset | `password_reset` | `boolean`     | ‚ùå No    | Default: `false`      |
| Created Date   | `created_at`     | `timestamptz` | ‚úÖ Yes   | Auto-generated        |

### **Related Tables**

- **`auth.users`**: Supabase Auth table for authentication
- **`coaches`**: Linked via email for coach-specific data
- **`schedules`**: Linked via `created_by` for schedule ownership
- **`team_updates`**: Linked via `coach_id` for update authorship
- **`coach_messages`**: Linked via `author_id` for message authorship

---

## üìä **AUDIT & LOGGING TABLES**

### **Table: `audit_logs`**

| Field     | Database Column | Data Type     | Purpose                   |
| --------- | --------------- | ------------- | ------------------------- |
| Action    | `action`        | `text`        | Type of action performed  |
| Table     | `table_name`    | `text`        | Database table affected   |
| Record ID | `record_id`     | `uuid`        | ID of affected record     |
| User      | `user_id`       | `uuid`        | User who performed action |
| Timestamp | `created_at`    | `timestamptz` | When action occurred      |

### **Table: `login_logs`**

| Field      | Database Column | Data Type     | Purpose             |
| ---------- | --------------- | ------------- | ------------------- |
| User       | `user_id`       | `uuid`        | User who logged in  |
| IP Address | `ip_address`    | `text`        | Login IP address    |
| User Agent | `user_agent`    | `text`        | Browser information |
| Timestamp  | `created_at`    | `timestamptz` | Login time          |

### **Table: `error_logs`**

| Field         | Database Column | Data Type     | Purpose                    |
| ------------- | --------------- | ------------- | -------------------------- |
| Error Message | `error_message` | `text`        | Error description          |
| Stack Trace   | `stack_trace`   | `text`        | Technical error details    |
| User          | `user_id`       | `uuid`        | User who encountered error |
| Timestamp     | `created_at`    | `timestamptz` | When error occurred        |

---

## üîó **RELATIONSHIPS & FOREIGN KEYS**

### **Primary Relationships**

- **Teams ‚Üí Players**: `teams.id` ‚Üí `players.team_id`
- **Users ‚Üí Schedules**: `users.id` ‚Üí `schedules.created_by`
- **Teams ‚Üí Schedules**: `teams.id` ‚Üí `schedules.team_id`
- **Users ‚Üí Team Updates**: `users.id` ‚Üí `team_updates.coach_id`
- **Teams ‚Üí Team Updates**: `teams.id` ‚Üí `team_updates.team_id`
- **Users ‚Üí Coach Messages**: `users.id` ‚Üí `coach_messages.author_id`
- **Teams ‚Üí Practice Drills**: `teams.id` ‚Üí `practice_drills.team_id`
- **Users ‚Üí Practice Drills**: `users.id` ‚Üí `practice_drills.created_by`

### **Authentication Relationships**

- **Auth Users ‚Üí Users**: `auth.users.id` ‚Üí `users.id`
- **Users ‚Üí Coaches**: `users.email` ‚Üí `coaches.email`

---

## üõ°Ô∏è **SECURITY & PERMISSIONS**

### **Row Level Security (RLS)**

- **Coaches**: RLS policies control access to coach data
- **Teams**: RLS policies control team data access
- **Players**: RLS policies control player data access
- **Schedules**: RLS policies control schedule access
- **Messages**: RLS policies control message access

### **User Roles**

- **Admin**: Full access to all data and functions
- **Coach**: Limited access to assigned team data only

---

## üìù **NOTES & CONSIDERATIONS**

### **Data Validation**

- Age validation uses `date_of_birth` to calculate age
- Gender validation ensures team compatibility
- Team assignment validation prevents age/gender mismatches

### **File Storage**

- Images stored in Supabase Storage
- URLs stored in database as text fields
- Automatic file naming based on team/coach names

### **Soft Deletes**

- Most tables use `deleted_at` for soft deletes
- Allows data recovery and audit trails
- Maintains referential integrity

### **Timestamps**

- All tables include `created_at` timestamps
- Some tables include `updated_at` for modification tracking
- Automatic timestamp generation via database triggers

---

_Last Updated: October 22, 2025_  
_Database Version: Supabase PostgreSQL_  
_Schema Version: 1.0_
